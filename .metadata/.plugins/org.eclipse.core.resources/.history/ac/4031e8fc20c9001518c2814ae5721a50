package Commands;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.net.URLConnection;

import org.omg.CORBA.portable.InputStream;

import java.lang.reflect.Constructor;
import java.lang.reflect.Method;

public class DynamicClassInterface extends ClassLoader{

	 public DynamicClassInterface(ClassLoader parent) {
	        super(parent);
	    }
	
		
	 public Class loadClass(String name) throws ClassNotFoundException {
	        if(!"Commands.Command1".equals(name))
	                return super.loadClass(name);

	        try {
	            String url = "file:C:\Users\sagaudre\Desktop\École\LOG8340\LOG8430\TP1Option1\src\Commands\Command1.java";
	            URL myUrl = new URL(url);
	            URLConnection connection = myUrl.openConnection();
	            java.io.InputStream input = connection.getInputStream();
	            ByteArrayOutputStream buffer = new ByteArrayOutputStream();
	            int data = input.read();

	            while(data != -1){
	                buffer.write(data);
	                data = input.read();
	            }

	            input.close();

	            byte[] classData = buffer.toByteArray();

	            return defineClass("reflection.MyObject",
	                    classData, 0, classData.length);

	        } catch (MalformedURLException e) {
	            e.printStackTrace();
	        } catch (IOException e) {
	            e.printStackTrace();
	        }

	        return null;
	    }
	 }

